<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Stephanie Lao">
<meta name="dcterms.date" content="2025-05-05">

<title>Stephanie J. Lao - Exponential Families</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-WLVLPRJF12"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-WLVLPRJF12', { 'anonymize_ip': true});
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Stephanie J. Lao</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../projects.html" rel="" target="">
 <span class="menu-text">Papers</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../portfolio.html" rel="" target="">
 <span class="menu-text">Portfolio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../skills.html" rel="" target="">
 <span class="menu-text">Skills</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#proof-of-theorem-1a" id="toc-proof-of-theorem-1a" class="nav-link" data-scroll-target="#proof-of-theorem-1a">Proof of Theorem 1(a)</a></li>
  <li><a href="#proof-of-theorem-1b" id="toc-proof-of-theorem-1b" class="nav-link" data-scroll-target="#proof-of-theorem-1b">Proof of Theorem 1(b)</a></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples">Examples</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Exponential Families</h1>
  <div class="quarto-categories">
    <div class="quarto-category">statistics</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Stephanie Lao </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 5, 2025</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction">Introduction</h3>
<p>The exponential family is a mathematically convenient set of distributions, including the normal, Poisson, exponential, and gamma distributions as special cases. Outside of its wide use in classical statistical theory, its importance also reaches machine learning, such as in generalized linear models (GLMs).</p>
<p>Expressing different probability density functions (pdf) or probability mass functions (pmf) in the form of an exponential family gives a convenient way to find the mean and variance of a random variable. We will give a brief introduction to the exponential family by providing a theorem that gives the mean and variance of a random variable belonging to an exponential family in terms of first and second derivatives, and include a two-part proof of this theorem. We will also give working examples to illustrate the theorem using the Poisson distribution and the binomial distribution with a fixed number of trials.</p>
<p><strong>Definition</strong>: An exponential family is a family of distributions whose pdf or pmf can be expressed in the form</p>
<p><span class="math display">\[\begin{equation}
    f(x|\theta) = h(x) c(\theta) \exp{ \left ( \sum_{i=1}^k w_i (\theta) t_i (x) \right )}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(h(x)\)</span> and <span class="math inline">\(t_i(x)\)</span> do not depend on <span class="math inline">\(\theta\)</span> and <span class="math inline">\(c(\theta)\)</span> does not depend on <span class="math inline">\(x\)</span>.</p>
<p>The following theorem gives the mean and variance of a random variable with a pdf or pmf that can be expressed in the form of an exponential family.</p>
<p><strong>Theorem 1</strong>: Suppose a random variable <span class="math inline">\(X\)</span> has a pdf or pmf that can be expressed in the form of an exponential family. Then,</p>
<p><span class="math display">\[\begin{equation}
\textrm{(a)} \  E \left ( \sum_{i=1}^k \frac{\partial w_i (\theta)}{\partial \theta_j} t_i(x) \right ) = - \frac{\partial}{\partial \theta_j} \ln c(\theta)
\end{equation}\]</span></p>
<p>and</p>
<p><span class="math display">\[\begin{equation}
\textrm{(b)} \  \textrm{var} \left ( \sum_{i=1}^k \frac{\partial w_i (\theta)}{\partial \theta_j} t_i(x) \right ) = - \frac{\partial^2}{\partial \theta_j^2} \ln c(\theta) - E \left ( \sum_{i=1}^k \frac{\partial^2 w_i (\theta)}{\partial \theta_j^2} t_i(x) \right )
\end{equation}\]</span></p>
</section>
<section id="proof-of-theorem-1a" class="level3">
<h3 class="anchored" data-anchor-id="proof-of-theorem-1a">Proof of Theorem 1(a)</h3>
<p>To prove part (a) of Theorem 1, we start by using the knowledge that the area under the pdf curve is 1 and the definition of exponential families to see that</p>
<p><span class="math display">\[\begin{equation*}
\begin{aligned}
    \int_x f(x|\theta) dx &amp;= 1 \\
    \int_x h(x) c(\theta) \exp \left ( \sum_{i=1}^k w_i(\theta) t_i(x) \right ) dx &amp;= 1 \\
\end{aligned}
\end{equation*}\]</span></p>
<p>We differentiate both sides of the above equation with respect to <span class="math inline">\(\theta_j\)</span> to get</p>
<p><span class="math display">\[\begin{equation*}
\begin{aligned}
    &amp;\int_x h(x) \frac{\partial c(\theta)}{\partial \theta_j} \exp \left ( \sum_{i=1}^k w_i(\theta) t_i(x) \right ) dx \\
    + &amp;\int_x h(x) c(\theta) \sum_{i=1}^k \left ( \frac{\partial w_i(\theta)}{\partial \theta_j} t_i (x) \right ) \exp \left ( \sum_{i=1}^k w_i(\theta) t_i(x) \right ) dx = 0
\end{aligned}
\end{equation*}\]</span></p>
<p>We then multiply the first integral by <span class="math inline">\(\frac{c(\theta)}{c(\theta)}\)</span> to get</p>
<p><span class="math display">\[\begin{equation*}
\begin{aligned}
    &amp;\int_x h(x) \frac{\partial c(\theta)}{\partial \theta_j} \exp \left ( \sum_{i=1}^k w_i(\theta) t_i(x) \right ) \frac{c(\theta)}{c(\theta)} dx \\
    + &amp;\int_x h(x) c(\theta) \sum_{i=1}^k \left ( \frac{\partial w_i(\theta)}{\partial \theta_j} t_i (x) \right ) \exp \left ( \sum_{i=1}^k w_i(\theta) t_i(x) \right ) dx = 0
\end{aligned}
\end{equation*}\]</span></p>
<p>Using the knowledge that <span class="math inline">\(\frac{\partial \ln c(\theta)}{\partial \theta_j} = \frac{\partial c(\theta)}{\partial \theta_j} \frac{1}{c(\theta)}\)</span>, see that</p>
<p><span class="math display">\[\begin{equation*}
\begin{aligned}
    &amp;\int_x h(x) c(\theta) \frac{\partial \ln c(\theta)}{\partial \theta_j} \exp \left ( \sum_{i=1}^k w_i(\theta) t_i(x) \right )  dx \\
    + &amp;\int_x h(x) c(\theta) \sum_{i=1}^k \left ( \frac{\partial w_i(\theta)}{\partial \theta_j} t_i (x) \right ) \exp \left ( \sum_{i=1}^k w_i(\theta) t_i(x) \right ) dx = 0
\end{aligned}
\end{equation*}\]</span></p>
<p>After rearranging, we get</p>
<p><span class="math display">\[\begin{equation*}
\begin{aligned}
    \int_x  \sum_{i=1}^k \left ( \frac{\partial w_i(\theta)}{\partial \theta_j} t_i (x) \right ) h(x) c(\theta) \exp \left ( \sum_{i=1}^k w_i(\theta) t_i(x) \right ) dx &amp;= \\
    - \frac{\partial \ln c(\theta)}{\partial \theta_j} \int_x h(x) c(\theta) \exp \left ( \sum_{i=1}^k w_i(\theta) t_i(x) \right )  dx \\
\end{aligned}
\end{equation*}\]</span></p>
<p>Finally, see that this is equivalent to</p>
<p><span class="math display">\[\begin{equation*}
\begin{aligned}
    E \left ( \sum_{i=1}^k \frac{\partial w_i (\theta)}{\partial \theta_j} t_i(x) \right ) = - \frac{\partial}{\partial \theta_j} \ln c(\theta)
\end{aligned}
\end{equation*}\]</span></p>
<p></p>
</section>
<section id="proof-of-theorem-1b" class="level3">
<h3 class="anchored" data-anchor-id="proof-of-theorem-1b">Proof of Theorem 1(b)</h3>
<p>To prove part (b) of Theorem 1, we differentiate a second time. From part (a) we found that</p>
<p><span class="math display">\[\begin{equation*}
\begin{aligned}
    &amp;\int_x  \sum_{i=1}^k \left ( \frac{\partial w_i(\theta)}{\partial \theta_j} t_i (x) \right ) h(x) c(\theta) \exp \left ( \sum_{i=1}^k w_i(\theta) t_i(x) \right ) dx \\
    + &amp;\frac{\partial \ln c(\theta)}{\partial \theta_j} \int_x h(x) c(\theta) \exp \left ( \sum_{i=1}^k w_i(\theta) t_i(x) \right )  dx \\
    &amp;= 0\\
\end{aligned}
\end{equation*}\]</span></p>
<p>We differentiate both sides of the above equation with respect to <span class="math inline">\(\theta_j\)</span> to get</p>
<p><span class="math display">\[\begin{equation*}
\begin{aligned}
    &amp;\int_x  \sum_{i=1}^k \left ( \frac{\partial^2 w_i(\theta)}{\partial \theta_j^2} t_i (x) \right ) h(x) c(\theta) \exp \left ( \sum_{i=1}^k w_i(\theta) t_i(x) \right ) dx \\
    + &amp;\int_x  \sum_{i=1}^k \left ( \frac{\partial w_i(\theta)}{\partial \theta_j} t_i (x) \right ) h(x) \frac{\partial c(\theta)}{\partial \theta_j} \exp \left ( \sum_{i=1}^k w_i(\theta) t_i(x) \right ) dx \\
    + &amp;\int_x  \sum_{i=1}^k \left ( \frac{\partial w_i(\theta)}{\partial \theta_j} t_i (x) \right ) h(x) c(\theta) \sum_{i=1}^k \left( \frac{\partial w_i(\theta)}{\partial \theta_j} t_i(x) \right ) \exp \left ( \sum_{i=1}^k w_i(\theta) t_i(x) \right ) dx \\
    + &amp;\frac{\partial^2 \ln c(\theta)}{\partial \theta_j^2} \int_x h(x) c(\theta) \exp \left ( \sum_{i=1}^k w_i(\theta) t_i(x) \right )  dx \\
    + &amp; \frac{\partial \ln c(\theta)}{\partial \theta_j} \int_x h(x) \frac{\partial c(\theta)}{\partial \theta_j} \exp \left ( \sum_{i=1}^k w_i(\theta) t_i(x) \right )  dx \\
    + &amp; \frac{\partial \ln c(\theta)}{\partial \theta_j} \int_x h(x) c(\theta) \sum_{i=1}^k \left( \frac{\partial w_i(\theta)}{\partial \theta_j} t_i(x) \right ) \exp \left ( \sum_{i=1}^k w_i(\theta) t_i(x) \right )  dx \\
    &amp;= 0\\
\end{aligned}
\end{equation*}\]</span></p>
<p>We then multiply the second and fifth terms by <span class="math inline">\(\frac{c(\theta)}{c(\theta)}\)</span> and use the knowledge that <span class="math inline">\(\frac{\partial \ln c(\theta)}{\partial \theta_j} = \frac{\partial c(\theta)}{\partial \theta_j} \frac{1}{c(\theta)}\)</span> to get</p>
<p><span class="math display">\[\begin{equation*}
\begin{aligned}
    &amp;\int_x  \sum_{i=1}^k \left ( \frac{\partial^2 w_i(\theta)}{\partial \theta_j^2} t_i (x) \right ) h(x) c(\theta) \exp \left ( \sum_{i=1}^k w_i(\theta) t_i(x) \right ) dx \\
    + &amp;\int_x  \sum_{i=1}^k \left ( \frac{\partial w_i(\theta)}{\partial \theta_j} t_i (x) \right ) h(x) c(\theta) \frac{\partial \ln c (\theta)}{\partial \theta_j}\exp \left ( \sum_{i=1}^k w_i(\theta) t_i(x) \right ) dx \\
    + &amp;\int_x  \left ( \sum_{i=1}^k \left ( \frac{\partial w_i(\theta)}{\partial \theta_j} t_i (x) \right ) \right )^2 h(x) c(\theta)  \exp \left ( \sum_{i=1}^k w_i(\theta) t_i(x) \right ) dx \\
    + &amp;\frac{\partial^2 \ln c(\theta)}{\partial \theta_j^2} \int_x h(x) c(\theta) \exp \left ( \sum_{i=1}^k w_i(\theta) t_i(x) \right )  dx \\
    + &amp; \frac{\partial \ln c(\theta)}{\partial \theta_j} \int_x h(x) c(\theta) \frac{\partial \ln c(\theta)}{\partial \theta_j} \exp \left ( \sum_{i=1}^k w_i(\theta) t_i(x) \right )  dx \\
    + &amp; \frac{\partial \ln c(\theta)}{\partial \theta_j} \int_x h(x) c(\theta) \sum_{i=1}^k \left( \frac{\partial w_i(\theta)}{\partial \theta_j} t_i(x) \right ) \exp \left ( \sum_{i=1}^k w_i(\theta) t_i(x) \right )  dx \\
    &amp;= 0\\
\end{aligned}
\end{equation*}\]</span></p>
<p>After simplifying and rearranging we get</p>
<p><span class="math display">\[\begin{equation*}
\begin{aligned}
    &amp;E \left (  \sum_{i=1}^k \frac{\partial^2 w_i(\theta)}{\partial \theta_j^2} t_i (x) \right )
    + \frac{\partial \ln c(\theta)}{\partial \theta_j} E \left ( \sum_{i=1}^k \frac{\partial w_i (\theta)}{\partial \theta_j} t_i(x) \right )
    + E \left [ \left ( \sum_{i=1}^k \frac{\partial w_i (\theta)}{\partial \theta_j} t_i(x) \right )^2 \right ]\\
    + &amp;\frac{\partial^2 \ln c(\theta)}{\partial \theta_j^2}
    + \left (\frac{\partial \ln c(\theta)}{\partial \theta_j} \right)^2
    + \frac{\partial \ln c(\theta)}{\partial \theta_j} E \left ( \sum_{i=1}^k \frac{\partial w_i (\theta)}{\partial \theta_j} t_i(x) \right )
    = 0\\
\end{aligned}
\end{equation*}\]</span></p>
<p>Using results from part (a) and simplifying, see that this is equivalent to</p>
<p><span class="math display">\[\begin{equation*}
    E \left (  \sum_{i=1}^k \frac{\partial^2 w_i(\theta)}{\partial \theta_j^2} t_i (x) \right )
    - \left ( \frac{\partial \ln c(\theta)}{\partial \theta_j} \right ) ^2
    + E \left [ \left ( \sum_{i=1}^k \frac{\partial w_i (\theta)}{\partial \theta_j} t_i(x) \right )^2 \right ]
    + \frac{\partial^2 \ln c(\theta)}{\partial \theta_j^2}
    = 0\\
\end{equation*}\]</span></p>
<p>We know that <span class="math inline">\(\textrm{var}(Q) = E(Q^2) - (EQ)^2\)</span> for a random variable <span class="math inline">\(Q\)</span>. Thus we get</p>
<p><span class="math display">\[\begin{equation*}
    \textrm{var} \left ( \sum_{i=1}^k \frac{\partial w_i (\theta)}{\partial \theta_j} t_i(x) \right ) = - \frac{\partial^2}{\partial \theta_j^2} \ln c(\theta) - E \left ( \sum_{i=1}^k \frac{\partial^2 w_i (\theta)}{\partial \theta_j^2} t_i(x) \right )
\end{equation*}\]</span></p>
<p></p>
</section>
<section id="examples" class="level3">
<h3 class="anchored" data-anchor-id="examples">Examples</h3>
<p>In this section, we will work through two examples to illustrate how to determine if a pdf or pmf of a random variable can be expressed as an exponential family. We then use the above theorem to find the mean and variance.</p>
<p><strong>Example 1</strong>: Let <span class="math inline">\(X \sim \textrm{Poisson} (\lambda)\)</span>. We can use the theorem to show that <span class="math inline">\(E(X) = \lambda\)</span> and <span class="math inline">\(\textrm{var}(X) = \lambda\)</span>.</p>
<p>The pmf of the Poisson distribution is given by</p>
<p><span class="math display">\[\begin{equation*}
    p(x) = \frac{\lambda^x e^{-\lambda}}{x!}
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(x = 0,1,...\)</span> and <span class="math inline">\(X\)</span> represents the number of events that occur in an interval of time.</p>
<p>We can show that <span class="math inline">\(p(x)\)</span> can be expressed as an exponential family.</p>
<p><span class="math display">\[\begin{equation*}
\begin{aligned}
    p(x) &amp;= \frac{\lambda^x e^{-\lambda}}{x!} \\
    &amp;= \frac{1}{x!} e^{-\lambda} \lambda^x  \\
    &amp;= \frac{1}{x!} e^{-\lambda} e^{x \ln \lambda}  \\
\end{aligned}
\end{equation*}\]</span></p>
<p>Therefore, we can conclude this pmf is an exponential family with</p>
<p><span class="math inline">\(h(x) = \frac{1}{x!}, c(\lambda) = e^{-\lambda}, t_1(x) = x,\)</span> and <span class="math inline">\(w_1(\lambda) = \ln \lambda\)</span>.</p>
<p>We can use part (a) of the theorem to find <span class="math inline">\(E(X)\)</span>. See that</p>
<p><span class="math display">\[\begin{equation*}
\begin{aligned}
    E \left ( \sum_{i=1}^k \frac{\partial w_i (\theta)}{\partial \theta_j} t_i(x) \right ) &amp;= E \left ( \sum_{i=1}^k \frac{\partial \ln \lambda}{\partial \lambda} x \right ) \\
    &amp;= E \left ( \sum_{i=1}^k  \frac{x}{\lambda} \right ) \\
    &amp;= - \frac{\partial}{\partial \theta_j} \ln c(\theta) \\
    &amp;= - \frac{\partial}{\partial \lambda} \ln (e^{-\lambda}) \\
    &amp;= - \frac{\partial}{\partial \lambda} (-\lambda) \\
    &amp;= 1 \\
\end{aligned}
\end{equation*}\]</span></p>
<p>Thus, we get</p>
<p><span class="math display">\[\begin{equation*}
\begin{aligned}
        \frac{E(X)}{\lambda} &amp;= 1 \\
        E(X) &amp;= \lambda
\end{aligned}
\end{equation*}\]</span></p>
<p>We can use part (b) of the theorem to find <span class="math inline">\(\textrm{var}(X)\)</span>. We have</p>
<p><span class="math display">\[\begin{equation*}
    \begin{aligned}
        \textrm{var} \left ( \sum_{i=1}^k \frac{\partial w_i (\theta)}{\partial \theta_j} t_i(x) \right ) &amp;= \textrm{var} \left ( \sum_{i=1}^k \frac{\partial \ln \lambda}{\partial \lambda} x \right ) \\
        &amp;= \textrm{var} \left ( \sum_{i=1}^k \frac{x}{\lambda} \right ) \\
        &amp;= - \frac{\partial^2}{\partial \theta_j^2} \ln c(\theta) - E \left ( \sum_{i=1}^k \frac{\partial^2 w_i (\theta)}{\partial \theta_j^2} t_i(x) \right ) \\
        &amp;= - \frac{\partial^2}{\partial \lambda^2} \ln (e^{-\lambda}) - E \left ( \sum_{i=1}^k \frac{\partial^2 \ln \lambda}{\partial \lambda^2} x \right ) \\
        &amp;= - \frac{\partial^2}{\partial \lambda^2} (-\lambda) - E \left ( \sum_{i=1}^k \frac{\partial^2 \ln \lambda}{\partial \lambda^2} x \right ) \\
        &amp;= 0 - E \left ( \sum_{i=1}^k \frac{-x}{\lambda^2}\right ) \\
        &amp;= \frac{1}{\lambda}
    \end{aligned}
\end{equation*}\]</span></p>
<p>Thus, we get</p>
<p><span class="math display">\[\begin{equation*}
\begin{aligned}
        \frac{1}{\lambda^2}\textrm{var}(X) &amp;= \frac{1}{\lambda} \\
        \textrm{var}(X) &amp;= \lambda
\end{aligned}
\end{equation*}\]</span></p>
<p><strong>Example 2</strong>: Let <span class="math inline">\(X \sim \textrm{b} (n,p)\)</span> with <span class="math inline">\(n\)</span> fixed. We can use the theorem to show that <span class="math inline">\(E(X) = np\)</span> and <span class="math inline">\(\textrm{var}(X) = np(1-p)\)</span>.</p>
<p>The pmf of the binomial distribution is given by</p>
<p><span class="math display">\[\begin{equation*}
    p(x) = \begin{pmatrix} n \\ x\end{pmatrix} p^x (1-p)^{n-x}
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(x = 0,1,...,n\)</span> and <span class="math inline">\(X\)</span> represents the number of successes among <span class="math inline">\(n\)</span> trials.</p>
<p>We can show that <span class="math inline">\(p(x)\)</span> can be expressed as an exponential family.</p>
<p><span class="math display">\[\begin{equation*}
\begin{aligned}
    p(x) &amp;= \begin{pmatrix} n \\ x\end{pmatrix} p^x (1-p)^{n-x} \\
    &amp;= \begin{pmatrix} n \\ x\end{pmatrix} p^x (1-p)^n \frac{1}{(1-p)^{x}} \\
    &amp;= \begin{pmatrix} n \\ x\end{pmatrix} (1-p)^n \left ( \frac{p}{1-p} \right ) ^x \\
    &amp;= \begin{pmatrix} n \\ x\end{pmatrix} (1-p)^n e^{x \ln \left ( \frac{p}{1-p} \right )} \\
\end{aligned}
\end{equation*}\]</span></p>
<p>Therefore, we can conclude this pmf is an exponential family with</p>
<p><span class="math inline">\(h(x) = \begin{pmatrix} n \\ x\end{pmatrix}, c(p) = (1-p)^n, t_1(x) = x,\)</span> and <span class="math inline">\(w_1(p) = \ln \left ( \frac{p}{1-p} \right )\)</span>.</p>
<p>We can use part (a) of the theorem to find <span class="math inline">\(E(X)\)</span>. See that</p>
<p><span class="math display">\[\begin{equation*}
\begin{aligned}
    E \left ( \sum_{i=1}^k \frac{\partial w_i (\theta)}{\partial \theta_j} t_i(x) \right ) &amp;= E \left ( \sum_{i=1}^k \frac{\partial}{\partial p} \left ( \ln \frac{p}{1-p} \right ) x \right ) \\
    &amp;= E \left ( \sum_{i=1}^k  \frac{x}{p-p^2} \right ) \\
    &amp;= - \frac{\partial}{\partial \theta_j} \ln c(\theta) \\
    &amp;= - \frac{\partial}{\partial p} \ln (1-p)^n \\
    &amp;= \frac{n}{1-p} \\
\end{aligned}
\end{equation*}\]</span></p>
<p>Thus, we get</p>
<p><span class="math display">\[\begin{equation*}
\begin{aligned}
        \frac{E(X)}{p - p^2} &amp;= \frac{n}{1-p} \\
        E(X) &amp;= np
\end{aligned}
\end{equation*}\]</span></p>
<p>We can use part (b) of the theorem to find <span class="math inline">\(\textrm{var}(X)\)</span>. We have</p>
<p><span class="math display">\[\begin{equation*}
    \begin{aligned}
        \textrm{var} \left ( \sum_{i=1}^k \frac{\partial w_i (\theta)}{\partial \theta_j} t_i(x) \right ) &amp;= \textrm{var} \left ( \sum_{i=1}^k \frac{\partial }{\partial p}  \left ( \ln \frac{p}{1-p} \right ) x \right ) \\
        &amp;= \textrm{var} \left ( \sum_{i=1}^k \frac{x}{p-p^2} \right ) \\
        &amp;= - \frac{\partial^2}{\partial \theta_j^2} \ln c(\theta) - E \left ( \sum_{i=1}^k \frac{\partial^2 w_i (\theta)}{\partial \theta_j^2} t_i(x) \right ) \\
        &amp;= - \frac{\partial^2}{\partial p^2} \ln (1-p)^n - E \left ( \sum_{i=1}^k \frac{\partial^2}{\partial p^2} \left ( \ln \frac{p}{1-p} \right ) x \right ) \\
        &amp;= \frac{n}{(1-p)^2} - E \left ( \sum_{i=1}^k \frac{2p-1 (x)}{(p-p^2)^2}\right ) \\
        &amp;= \frac{n}{(1-p)^2} - np \left ( \frac{2p-1}{(p-p^2)^2} \right ) \\
        &amp;= \frac{np^2 - 2np^2 + np}{(p-p^2)^2} \\
        &amp;= \frac{np(1-p)}{(p-p^2)^2} \\
    \end{aligned}
\end{equation*}\]</span></p>
<p>Thus, we get</p>
<p><span class="math display">\[\begin{equation*}
\begin{aligned}
        \frac{1}{(p-p^2)^2}\textrm{var}(X) &amp;= \frac{np(1-p)}{(p-p^2)^2} \\
        \textrm{var}(X) &amp;= np(1-p)
\end{aligned}
\end{equation*}\]</span></p>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">Conclusion</h3>
<p>In summary, we defined an exponential family as a set of probability distributions whose pdfs and pmfs can be expressed in a certain form, making them especially convenient to work with. We introduced a theorem that gave the mean and variance of a random variable belonging to an exponential family in terms of first and second derivatives. We then gave a two-part proof of this theorem.</p>
<p>We finally worked through two examples to illustrate the theorem using the Poisson distribution and the binomial distribution with a fixed number of trials. Note that the exponential family also includes other distributions such as the normal and gamma distributions, which can be illustrated in a similar fashion to the examples included here.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>